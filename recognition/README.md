# OASIS Brain image generation using StyleGAN

## Algorithm description

![res_block](https://github.com/Kevinli12123/PatternFlow/blob/s4574204-boli-styleGAN2/picture/v2-e27f75092944b85be833fd93f53dd35f_b.jpeg)

  &emsp;The images generated by GAN have developed rapidly in terms of resolution and quality, but before that, a lot of research work still regarded the generator as a black box, that is, lack of understanding of the image generation process of the generator, such as image diversity How to control the random features in, the nature of the latent space is also poorly understood.<br>
  &emsp;Inspired by style transfer, StyleGAN redesigned the generator network structure and tried to control the image generation process: the generator starts from the learned constant input, and adjusts the image "style" of each convolutional layer based on the latent code, thereby directly controlling Image features; in addition, combined with noise directly injected into the network, random attributes (such as freckles, hair) in the generated image can be changed. StyleGAN can achieve unsupervised attribute separation to a certain extent, and perform some style mixing or interpolation operations. 



## Brain image generation problem
<br>This is about creating the similar pictures of OASIS brain. It using the random latent factors to fit the distribution of pixels of the real image data and try to use the trained function to create the clear image.

## Train parameters and procedure
&emsp;Due to the time limit, I just sucessfully achevie the DCGAN and then try to achieve the StyleGAN. However, I didn't achieve it totally, so this documentation would introduce the training parameters of DCGAN and explain the model of StyleGAN. <br>
&emsp;The used activation is leaky Relu with alpha = 0.01.<br>
&emsp;The used optimizer is Adam and I used learning rate of .0005 <br>
&emsp;This project used Categorical cross entropy, and try to use thenon-saturating losses to measure. However, due to the time limit, I just used Structural Similarity Coefficient as a metric to monitor training. <br>
I trained the model for 40 ephocs.<br>

The dataset was already split into training test data sets. I used test dataset to assess model generalization capability on a set not seen during training. 

## Dependencies and data pre-processing 
&emsp;The OASIS dataset this project used is from the blackboard. It is the dealt datasets with the image. In order to use the dataset properly, this proejct write the function of loading the image and transfer them into npz format. An update to these file paths might be required for the algorithm to run. 



## Output 
The below results show the ssim score is 0.625's graph.

![res_block](https://github.com/Kevinli12123/PatternFlow/blob/s4574204-boli-styleGAN2/picture/generated_plot_e008.png)


## model summery

&emsp;The StyleGAN first using the map function to transform the latent data distribution to the similiar and then add this points to the networks of GAN. During the transformation of data to the pixels, it also add the noise points to make it more real. These designs would sucessfully create the image that is similar style to the picture we use.

![res_block](https://github.com/Kevinli12123/PatternFlow/blob/s4574204-boli-styleGAN2/picture/Generator-architecture-of-the-StyleGAN-neural-network-1.png)


