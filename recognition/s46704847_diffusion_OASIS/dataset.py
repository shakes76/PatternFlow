# -*- coding: utf-8 -*-
"""dataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1ebIE7dlwSnsaJe7G0ngCuGTSa9qdSVKz
"""

import zipfile
import numpy as np
from PIL import Image
import matplotlib.pyplot as plt

path = '/content/drive/MyDrive/comp3710/dataset/keras_png_slices_data.zip'

def get_dataset(path, batch_size=32):
  zipped_images = zipfile.ZipFile(path)
  image_list = zipped_images.namelist()
  image_list = [image for image in image_list if '.png' in image]
  train_images = np.array([np.array(Image.open(zipped_images.open(image))) 
                                                  for image in image_list])
  train_images = train_images / 127.5 - 1
  train_images = train_images[:,:,:,np.newaxis]
  return train_images

train_images = get_dataset(path)

train_images.shape

